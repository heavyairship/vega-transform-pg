import{inherits as e,Transform as r}from"vega";var t=require("querystring"),n=require("http");function o(e){r.call(this,[],e)}o.Definition={type:"PostgresTransform",metadata:{changes:!0,source:!0},params:[{name:"query",type:"string",required:!0}]},o.query=function(e){this.query=e},e(o,r).transform=function(e,r){try{var o=this;return Promise.resolve(new Promise(function(e,r){var i=t.stringify({query:o.query}),a={hostname:"localhost",port:3e3,method:"POST",path:"/query",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":Buffer.byteLength(i)}},s=n.request(a,function(r){var t="";r.on("data",function(e){t+=e}),r.on("end",function(){console.log(JSON.parse(t).rows),e(t)})});s.on("error",function(e){console.error("Error: "+e),r()}),s.write(i),s.end()}))}catch(e){return Promise.reject(e)}};export default o;
//# sourceMappingURL=vega-transform-pg.mjs.map
