var e=require("vega"),r=require("querystring"),n=require("http");function t(r){e.Transform.call(this,[],r)}t.Definition={type:"VegaTransformPostgres",metadata:{changes:!0,source:!0},params:[{name:"query",type:"string",required:!0}]},t.setQuery=function(e){this.query=e},e.inherits(t,e.Transform).transform=function(e,t){try{var o=this;return Promise.resolve(new Promise(function(e,t){var i=r.stringify({query:o.query}),s={hostname:"localhost",port:3e3,method:"POST",path:"/query",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":Buffer.byteLength(i)}},a=n.request(s,function(r){var n="";r.on("data",function(e){n+=e}),r.on("end",function(){console.log(JSON.parse(n).rows),e(n)})});a.on("error",function(e){console.error("Error: "+e),t()}),a.write(i),a.end()}))}catch(e){return Promise.reject(e)}},module.exports=t;
//# sourceMappingURL=vega-transform-pg.js.map
