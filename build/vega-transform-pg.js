var r=require("vega"),e=require("querystring"),n=require("http");function t(e){r.Transform.call(this,[],e)}t.Definition={type:"PostgresTransform",metadata:{changes:!0,source:!0},params:[{name:"query",type:"string",required:!0}]},t.query=function(r){this.query=r},r.inherits(t,r.Transform).transform=function(r,t){try{var o=this;return Promise.resolve(new Promise(function(r,t){var i=e.stringify({query:o.query}),s={hostname:"localhost",port:3e3,method:"POST",path:"/query",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":Buffer.byteLength(i)}},a=n.request(s,function(e){var n="";e.on("data",function(r){n+=r}),e.on("end",function(){console.log(JSON.parse(n).rows),r(n)})});a.on("error",function(r){console.error("Error: "+r),t()}),a.write(i),a.end()}))}catch(r){return Promise.reject(r)}},module.exports=t;
//# sourceMappingURL=vega-transform-pg.js.map
